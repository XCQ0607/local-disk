name: Build and Push Docker Image
on:
 push:
   branches:
     - main # 在 main 分支有提交时触发
jobs:
 build:
   runs-on: ubuntu-latest
   steps:
     # 检出代码
     - name: Checkout code
       uses: actions/checkout@v3
     # 设置 QEMU 支持多架构
     - name: Set up QEMU
       uses: docker/setup-qemu-action@v2
     # 设置 Docker Buildx
     - name: Set up Docker Buildx
       uses: docker/setup-buildx-action@v2
     # 登录 Docker Hub
     - name: Log in to Docker Hub
       uses: docker/login-action@v2
       with:
         username: ${{ secrets.DOCKERHUB_USER }}
         password: ${{ secrets.DOCKERHUB_TOKEN }}
     # 构建并推送镜像
     - name: Build and Push Docker Image
       uses: docker/build-push-action@v3
       with:
         context:
         file: ./Dockerfile # 指定 Dockerfile 路径
         platforms: linux/amd64,linux/arm64 # 多架构支持
         push: true
         tags: ${{ secrets.DOCKERHUB_USER }}/my-image:latest
